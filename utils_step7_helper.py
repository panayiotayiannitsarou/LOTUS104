
import pandas as pd

def enrich_for_step7(df: pd.DataFrame) -> pd.DataFrame:
    """
    Προσθέτει στήλη 'ΒΗΜΑ' στο df, η οποία δείχνει από ποιο Βήμα τοποθετήθηκε ο μαθητής.
    Χρησιμοποιείται για τις ανταλλαγές στο Βήμα 7.
    """
    df = df.copy()

    # Αρχικοποίηση στήλης
    df["ΒΗΜΑ"] = ""

    # Βήμα 5 – Μαθητές που έχουν τιμή στη στήλη ΟΜΑΔΑ
    df.loc[df["ΟΜΑΔΑ"].notna(), "ΒΗΜΑ"] = 5

    # Βήμα 6 – Όσοι δεν έχουν ΟΜΑΔΑ αλλά έχουν ΤΜΗΜΑ (οπότε τοποθετήθηκαν στο Βήμα 6)
    df.loc[(df["ΟΜΑΔΑ"].isna()) & (df["ΤΜΗΜΑ"].notna()), "ΒΗΜΑ"] = 6

    return df
